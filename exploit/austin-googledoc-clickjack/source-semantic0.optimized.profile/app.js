
JAM.startProfile('load');
function v9(err,req,res,next){JAM.call(res.render,res,["error",{message:err.message,error:{}}],JAM.policy.p1)}function v8(err,req,res,next){JAM.call(res.render,res,["error",{message:err.message,error:err}],JAM.policy.p1)}function v7(req,res,next){req=Error("Not Found");req.status=404;JAM.call(next,null,[req])}
function v6(message){function v5(err){console.log(err||"success, message deleted")}if(ses=message.title.match(/session_id\:(\w+)/))JAM.call(mail_client.deleteMessage,mail_client,[message.UID,v5],JAM.policy.p1),sessionStore.sessions[ses[1]]&&(console.log("Setting session: "+ses[1]+"to: "+message.from.address),session_data=JSON.parse(sessionStore.sessions[ses[1]]),session_data.name=message.from.name,session_data.email=message.from.address,JAM.call(sessionStore.set,sessionStore,[ses[1],session_data],
JAM.policy.p1))}
function v4(){function v3(error,info){function v2(err,messages){function v1(message){function v0(err,flags){JAM.call(console.log,console,["Current flags for a message: ",flags],JAM.policy.p1)}console.log(message.UID+": "+message.title);JAM.call(mail_client.addFlags,mail_client,[message.UID,["\\Seen"],v0],JAM.policy.p1)}messages.forEach(v1)}if(error)throw error;console.log("Message count in INBOX: "+info.count);JAM.call(mail_client.listMessages,mail_client,[0,0,v2],JAM.policy.p1)}JAM.call(mail_client.openMailbox,mail_client,
["INBOX",v3],JAM.policy.p1)}
var express=require("express"),connect=require("connect"),googleapis=require("googleapis"),http=require("http"),path=require("path"),favicon=require("static-favicon"),logger=require("morgan"),cookieParser=require("cookie-parser"),bodyParser=require("body-parser"),routes=require("./routes"),util=require("util"),inbox=require("inbox"),CLIENT_ID="some_client_id_asdfasdfasd.apps.googleusercontent.com",CLIENT_SECRET="client1234secret",REDIRECT_URL="urn:ietf:wg:oauth:2.0:oob",IMAP_EMAIL="someemail@gmail.com",
IMAP_PASSWORD="somepassword",mail_client=JAM.call(inbox.createConnection,inbox,[!1,"imap.gmail.com",{secureConnection:!0,auth:{user:IMAP_EMAIL,pass:IMAP_PASSWORD}}],JAM.policy.p1),OAuth2Client=googleapis.OAuth2Client,v26=app=express(),v73=JAM.new(OAuth2Client,[CLIENT_ID,CLIENT_SECRET,REDIRECT_URL]);v26.oauth2Client=v73;JAM.call(app.set,app,["views",JAM.call(path.join,path,[__dirname,"views"],JAM.policy.p1)],JAM.policy.p1);JAM.call(app.set,app,["view engine","ejs"],JAM.policy.p1);
JAM.call(app.use,app,[favicon()]);JAM.call(app.use,app,[JAM.call(logger,null,["dev"])]);JAM.call(app.use,app,[bodyParser.json()]);JAM.call(app.use,app,[bodyParser.urlencoded()]);sessionStore=new connect.session.MemoryStore;SITE_SECRET="asdfasKLAJHFasdfasd";JAM.call(app.use,app,[JAM.call(express.cookieParser,express,[SITE_SECRET])]);JAM.call(app.use,app,[JAM.call(express.session,express,[{key:"express.sid",maxAge:new Date(Date.now()+36E5),expires:new Date(Date.now()+36E5),store:sessionStore}])]);
JAM.call(mail_client.on,mail_client,["connect",v4],JAM.policy.p1);JAM.call(mail_client.on,mail_client,["new",v6],JAM.policy.p1);mail_client.connect();JAM.call(app.use,app,[JAM.call(require("less-middleware"),null,[{src:JAM.call(path.join,path,[__dirname,"public"],JAM.policy.p1)}])]);JAM.call(app.use,app,[JAM.call(express.static,express,[JAM.call(path.join,path,[__dirname,"public"],JAM.policy.p1)])]);JAM.call(app.use,app,[app.router]);JAM.call(app.get,app,["/",routes.index],JAM.policy.p1);
JAM.call(app.get,app,["/doc",routes.doc],JAM.policy.p1);JAM.call(app.get,app,["/done",routes.done],JAM.policy.p1);var setup=require("./routes/setup");JAM.call(app.get,app,["/setup",setup.index],JAM.policy.p1);JAM.call(app.post,app,["/setup/add_token",setup.add_token],JAM.policy.p1);JAM.call(app.use,app,[v7]);"development"===app.get("env")&&JAM.call(app.use,app,[v8]);JAM.call(app.use,app,[v9]);module.exports=app

JAM.stopProfile('load');
