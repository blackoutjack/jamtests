
Downloaded 2014-12-09 from
http://www.schillmania.com/content/entries/2009/javascript-malware-obfuscation-analysis/

This code purportedly doesn't do anything (perhaps it is date-dependent
or the like). It's just used as an example of obfuscation. After
figuring out some plausible behavior, policies could be applied to
prevent them to show that obfuscation is not a problem.


From schillmania.com:

Holy Crap, This Thing Is Bad (Or, "Latin Lingo")

This particular beast was found in the wild in May 2009 on a site phishing for Facebook user credentials, and is a particularly-nasty bugger. Note the number of strangely-named variables created up front, many of which are not even referenced in the code blocks that follow. Additionally notice the odd ternary statements which have no impact on the operation of the code, and presumably must exist to trip up scanners (unless there is a fancy form of string replacement on the body of some functions, in which case the functions could be mutated before execution - and that would be scary. A cipher based on the body of the function has also been seen.)

Additionally, there is evidence of concatenating a string to be used for decryption/decoding and/or string substitution, in addition to string concatenation for referencing object attributes and methods eg. window and open(), as well as numerous deeply-nested function calls.

This script defines a mix of variables and functions, interleaved in blocks. Perhaps incomplete or buggy, it didn't seem to actually do anything when run; a second copy was later downloaded - the "encryption" algorithm seemed to change very quickly, as you'll see - and despite still not working, an analysis was attempted nonetheless.
