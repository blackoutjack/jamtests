var x = new XMLHttpRequest;
x.open("GET", window.location.href, true);
x.onreadystatechange = function() {
  if (x.readyState == 2) {
    (opener || top).postMessage(JSON.stringify({headers:x.getAllResponseHeaders(), url:window.location.href, send:true}), "*");
  }
};
x.send()
